ccm.component({name:"input",config:{style:[ccm.load,"./css/input.css"],store:[ccm.store,"./json/input.json"],key:"demo",submit:function(result){console.log(result)}},Instance:function(){var self=this;this.render=function(callback){var element=ccm.helper.element(self);self.store.get(self.key,function(dataset){if(dataset===null)return self.store.set({key:self.key},function(dataset){self.key=dataset.key;element.remove();self.render()});var html=[{tag:"table",inner:[]}];if(dataset.inputs)if(Array.isArray(dataset.inputs))for(var i=0;i<dataset.inputs.length;i++)addInput(dataset.inputs[i]);else addInput(dataset.inputs);if(dataset.fieldset){html={tag:"fieldset",inner:html};if(typeof dataset.fieldset==="string")html.inner.unshift({tag:"legend",inner:dataset.fieldset})}if(dataset.form){if(dataset.form===true)dataset.form={button:true};html={tag:"form",onsubmit:dataset.form.onsubmit,inner:html};if(dataset.form.button){var button={tag:"input",type:"submit",value:dataset.form.button};if(button.value===true)delete button.value;if(dataset.fieldset)html.inner.inner.push(button);else html.inner.push(button)}}element.html(ccm.helper.html(html,function(){self.submit(ccm.helper.formData(jQuery(this)));return false}));if(callback)callback();function addInput(input){if(self.data)integrate(self.data[input.name]);var label=input.label||input.name;delete input.label;switch(input.input){case"select":case"textarea":input.tag=input.input;break;default:input.tag="input";input.type=input.input}if(input.input==="radio"){for(var i=0;i<input.values.length;i++){input.values[i].tag=input.tag;input.values[i].type=input.type;input.values[i].name=input.name;input.values[i]={tag:"label",inner:[input.values[i],{tag:"span",inner:"&nbsp;"},{tag:"span",inner:input.values[i].caption||input.values[i].value},{tag:"br"}]};delete input.values[i].inner[0].caption}input=input.values}if(input.input==="checkbox"){if(input.values){for(var i=0;i<input.values.length;i++){input.values[i].tag=input.tag;input.values[i].type=input.type;input.values[i].value=input.values[i].value||input.values[i].name;input.values[i]={tag:"label",inner:[input.values[i],{tag:"span",inner:"&nbsp;"},{tag:"span",inner:input.values[i].caption||input.values[i].value},{tag:"span",inner:"&nbsp;&nbsp;&nbsp;"}]};delete input.values[i].inner[0].caption}input=input.values}else{input.id=self.index+"-"+input.name;label={tag:"label",for:input.id,inner:label};input=[input,{tag:"span",inner:"&nbsp;"},{tag:"span",inner:input.caption}];delete input[0].caption}}if(input.input==="select"){input.inner=input.options;delete input.options;for(var i=0;i<input.inner.length;i++){input.inner[i].tag="option";input.inner[i].inner=input.inner[i].caption||input.inner[i].value;delete input.inner[i].caption}}if(input.input==="range"){input.oninput=function(){jQuery(this).next().next().text(jQuery(this).val())};input=[input,{tag:"span",inner:"&nbsp;"},{tag:"span",inner:input.value||(parseInt(input.min)||0)+(parseInt(input.max)||100)/2}]}delete input.input;html[0].inner.push({tag:"tr",inner:[{tag:"td",inner:label},{tag:"td",inner:input}]});function integrate(value){if(value===undefined)return;switch(input.input){case"radio":case"checkbox":delete input.checked;for(var i=0;i<input.values.length;i++){delete input.values[i].checked;if(input.values[i].value||input.values[i].caption===value)input.values[i].checked=true}break;case"select":for(var i=0;i<input.options.length;i++){delete input.options[i].selected;if(input.options[i].value===value)input.options[i].selected=true}break;case"textarea":input.inner=value;break;default:input.value=value}}}})}}});